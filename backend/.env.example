# Reddit OAuth Configuration
# Get these from https://www.reddit.com/prefs/apps after creating an app
# SECURITY: Never commit these values to git. Keep them in .env (gitignored)
REDDIT_CLIENT_ID=your_client_id_here
REDDIT_CLIENT_SECRET=your_client_secret_here
REDDIT_REDIRECT_URI=http://localhost:8000/oauth/reddit/callback
# For production, use: REDDIT_REDIRECT_URI=https://your.domain/oauth/reddit/callback
REDDIT_SCOPES=identity read
REDDIT_USER_AGENT=reddit-cluster-map/0.1 (+your_contact_info)

# Database Configuration
# SECURITY: Use strong passwords in production (min 16 chars, mix of letters, numbers, symbols)
# Consider using a secrets manager (AWS Secrets Manager, HashiCorp Vault, etc.)
POSTGRES_USER=postgres
POSTGRES_PASSWORD=your_secure_password_here
POSTGRES_DB=reddit_cluster

# If you change POSTGRES_USER, POSTGRES_PASSWORD, or POSTGRES_DB above, update DATABASE_URL accordingly
DATABASE_URL=postgres://postgres:your_secure_password_here@db:5432/reddit_cluster?sslmode=disable

# Security Settings
# Admin API token for protecting admin endpoints (e.g., /api/admin/*)
# SECURITY: Generate a strong random token (e.g., `openssl rand -base64 32`)
# This token should be at least 32 characters long and kept secret
ADMIN_API_TOKEN=your_admin_token_here
ENABLE_RATE_LIMIT=true
RATE_LIMIT_GLOBAL=100
RATE_LIMIT_GLOBAL_BURST=200
RATE_LIMIT_PER_IP=10
RATE_LIMIT_PER_IP_BURST=20
# CORS: Restrict to your actual frontend domains in production
CORS_ALLOWED_ORIGINS=http://localhost:5173,http://localhost:3000

# Graph generation settings
DETAILED_GRAPH=false
POSTS_PER_SUB_IN_GRAPH=10
COMMENTS_PER_POST_IN_GRAPH=50
MAX_AUTHOR_CONTENT_LINKS=3
MAX_POSTS_PER_SUB=25
POSTS_SORT=top
POSTS_TIME_FILTER=day

# Graph Precalculation Settings
DISABLE_API_GRAPH_JOB=false
PRECALC_CLEAR_ON_START=false
PRECALC_FORCE_CLEAR=false

# Precalculation batching and progress
GRAPH_NODE_BATCH_SIZE=1000
GRAPH_LINK_BATCH_SIZE=2000
GRAPH_PROGRESS_INTERVAL=10000

# Layout computation settings (force-directed graph layout)
# Maximum number of nodes to include in layout computation (higher = more complete but slower)
LAYOUT_MAX_NODES=5000
# Number of force-directed layout iterations (higher = better layout quality but slower)
LAYOUT_ITERATIONS=400
# Batch size for position updates to database
LAYOUT_BATCH_SIZE=5000
# Minimum distance threshold for position updates (0 = update all positions regardless of change)
LAYOUT_EPSILON=0.0

# HTTP and retry configuration
HTTP_MAX_RETRIES=3
HTTP_RETRY_BASE_MS=300
HTTP_TIMEOUT_MS=15000
LOG_HTTP_RETRIES=false
# Graph query timeout: Maximum time for graph data retrieval (reduced from 30s to 5s for better fail-fast)
GRAPH_QUERY_TIMEOUT_MS=5000
# Database statement timeout: Maximum time for individual SQL queries (reduced from 25s to 5s)
DB_STATEMENT_TIMEOUT_MS=5000

# Crawler rate limiting (Reddit API)
# Controls the rate of requests to Reddit's API
CRAWLER_RPS=1.66
CRAWLER_BURST_SIZE=1

# Crawler scheduling
STALE_DAYS=30
RESET_CRAWLING_AFTER_MIN=15

# Observability Settings
# Logging configuration
LOG_LEVEL=info  # Options: debug, info, warn, error
ENV=development  # Options: development, production

# OpenTelemetry Tracing
OTEL_ENABLED=false  # Set to true to enable distributed tracing
OTEL_EXPORTER_OTLP_ENDPOINT=localhost:4318  # OTLP collector endpoint
OTEL_TRACE_SAMPLE_RATE=0.1  # Sample rate (0.0 to 1.0), default 10%
SERVICE_VERSION=dev  # Service version for tracing and error reporting

# Sentry Error Reporting
SENTRY_DSN=  # Your Sentry DSN (leave empty to disable)
SENTRY_ENVIRONMENT=development  # Options: development, staging, production
SENTRY_RELEASE=  # Optional: Sentry release version (defaults to SERVICE_VERSION)
SENTRY_SAMPLE_RATE=1.0  # Error sampling rate (0.0 to 1.0)

# Performance Profiling
# SECURITY: Only enable in development or controlled environments
# Exposes runtime profiling endpoints at /debug/pprof/* (admin-only)
ENABLE_PROFILING=false  # Set to true to enable pprof endpoints

# Cache Configuration
# Controls the LRU cache used for graph and community API responses
CACHE_MAX_SIZE_MB=512  # Maximum cache size in megabytes
CACHE_MAX_ENTRIES=10000  # Maximum number of cache entries
CACHE_TTL_SECONDS=60  # Time-to-live for cache entries in seconds
